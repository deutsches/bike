import{P as w}from"./PagnationComponent-7a8652f6.js";import{_ as f,r as y,o as l,c,d as t,F as g,h as m,a as P,t as a,b as _}from"./index-4a8a7585.js";const{VITE_APP_URL:u,VITE_APP_PATH:p}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"uaena",BASE_URL:"/bike/",MODE:"production",DEV:!1,PROD:!0},k={data(){return{orders:[],productAry:[],isEditing:!1,page:{},totalPage:0,currentPage:0}},components:{PagnationComponent:w},methods:{getData(i=1){this.$http.get(`${u}api/${p}/orders?page=${i}`).then(e=>{e.data.success&&(this.orders=e.data.orders,this.orders.forEach((n,d)=>{this.orders[d].productAry=[],Object.values(this.orders[d].products).forEach(h=>{this.orders[d].productAry.push(h)})}),this.page=e.data.pagination)}).catch(e=>{alert(e.data)})},moneyFormat(i){return i.replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")},deleteOrder(i){const e=`${u}api/${p}/admin/order/${i}`;this.$http.delete(e).then(n=>{alert(n.data.message),this.getData()}).catch(n=>{alert(n.response.data.message)})},editOrder(i){this.isEditing=!0;const e={...i};e.is_paid?e.is_paid=!1:e.is_paid=!0;const n=`${u}api/${p}/admin/order/${i.id}`;this.$http.put(n,{data:e}).then(d=>{alert(d.data.message),this.isEditing=!1,this.getData()}).catch(d=>{alert(d.response.data.message)})}},mounted(){this.getData()}},E={class:"container"},$={class:"row py-3"},A={class:"table table-hover mt-4"},D=t("thead",null,[t("tr",{class:""},[t("th",{width:"150"}),t("th",{width:"250"},"訂單編號"),t("th",{width:"250"},"訂單時間"),t("th",{width:"200"},"聯絡人資料"),t("th",{width:"120"},"預約日期"),t("th",{width:"120"},"預約金額"),t("th",{width:"150"},"是否付款"),t("th",{width:"150"},"編輯訂單")])],-1),v={class:""},x={class:"align-middle"},V=["data-bs-target"],C={width:"250",class:"align-middle"},O={width:"250",class:"align-middle"},T={width:"200",class:"align-middle"},B=t("br",null,null,-1),L=t("br",null,null,-1),N={width:"120",class:"align-middle"},F={width:"120",class:"align-middle"},I={width:"150",class:"align-middle"},R={class:"form-check form-switch"},S=["id","checked","onClick","disabled"],U=["for"],H={key:0,class:"text-success"},j={key:1,class:"text-danger"},q={width:"150",class:"align-middle"},M={class:"btn-group"},z=["onClick"],G=t("i",{class:"bi bi-trash"},null,-1),J=["id"],K={colspan:"7",class:"w-10"},Q=t("thead",null,[t("tr",{class:""},[t("th",{width:"200"},"圖片"),t("th",{width:"200"},"名稱"),t("th",{width:"200"},"數量"),t("th",{width:"200"},"金額")])],-1),W=["src"];function X(i,e,n,d,h,r){const b=y("PagnationComponent");return l(),c("div",E,[t("div",$,[t("table",A,[D,(l(!0),c(g,null,m(h.orders,s=>(l(),c("tbody",{key:s.id},[t("tr",v,[t("td",x,[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-toggle":"collapse","data-bs-target":`#collapse${s.id}`,"aria-expanded":"false"},"展開",8,V)]),t("td",C,a(s.id),1),t("td",O,a(new Date(s.create_at*1e3).toLocaleString()),1),t("td",T,[_(a(s.user.name)+" ",1),B,_(" "+a(s.user.tel)+" ",1),L,_(" "+a(s.user.email),1)]),t("td",N,a(s.user.address),1),t("td",F,a(r.moneyFormat(s.total.toString())),1),t("td",I,[t("div",R,[t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:s.id,checked:s.is_paid,onClick:o=>r.editOrder(s),disabled:h.isEditing},null,8,S),t("label",{class:"form-check-label",for:s.id},[s.is_paid?(l(),c("span",H,"已付款")):(l(),c("span",j,"未付款"))],8,U)])]),t("td",q,[t("div",M,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>r.deleteOrder(s.id)},[G,_("  刪除 ")],8,z)])])]),t("tr",{id:`collapse${s.id}`,class:"collapse"},[t("td",K,[Q,t("tbody",null,[(l(!0),c(g,null,m(s.productAry,o=>(l(),c("tr",{key:o.id},[t("td",null,[t("img",{src:o.product.imageUrl,alt:"產品圖片"},null,8,W)]),t("td",null,a(o.product.title),1),t("td",null,a(o.qty),1),t("td",null,a(o.final_total),1)]))),128))])])],8,J)]))),128))]),P(b,{page:h.page,"get-data":r.getData,onNextPage:r.getData},null,8,["page","get-data","onNextPage"])])])}const tt=f(k,[["render",X]]);export{tt as default};
