import{_ as y,o as x,c as g,d as s,t as d}from"./index-5b2c70a7.js";const{VITE_APP_URL:f,VITE_APP_PATH:v}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"uaena",BASE_URL:"/bike/",MODE:"production",DEV:!1,PROD:!0},b={data(){return{products:[],orders:[],income:[],outcome:[],category:[],totalIncome:0,totalOutcome:0}},methods:{getCount(){c3.generate({bindto:"#cal",data:{x:"x",columns:[["x","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01"],...this.income]},axis:{x:{type:"timeseries",tick:{format:"%Y-%m"}}}}),c3.generate({bindto:"#bike",data:{x:"x",columns:[["x","2023-01-01","2023-02-01","2023-03-01","2023-04-01","2023-05-01","2023-06-01","2023-07-01","2023-08-01","2023-09-01","2023-10-01","2023-11-01","2023-12-01"],...this.category],type:"bar"},axis:{x:{type:"timeseries",tick:{format:"%Y-%m"}}},bar:{width:{ratio:.5}}})},getOrders(){this.$http.get(`${f}api/${v}/admin/orders`).then(e=>{if(e.data.success){this.orders=e.data.orders,console.log(this.orders),this.income=e.data.orders,this.income=this.income.map(({create_at:t,products:o,productAry:n,...i})=>i),this.income=this.income.filter(t=>t.is_paid===!0);const a=[["總收入",...Array.from({length:12},(t,o)=>o+1).map(()=>0)]],r=this.income.reduce((t,o)=>{const n=new Date(o.user.address).getMonth();return t[n+1]+=o.total,this.totalIncome+=o.total*1,t},Array.from({length:13},()=>0));a[0].splice(1,12,...r.slice(1)),this.income=a;const c=["支出"],u=new Date().getMonth()+1;for(let t=1;t<=12;t+=1)if(t>u)c.push(0);else{const o=Math.floor(Math.random()*401)+100;this.totalOutcome+=o,c.push(o)}this.income.push(c),this.category=e.data.orders.map(({productAry:t,user:o})=>({productAry:t,user:o})),this.category=this.category.filter(t=>t.productAry!==void 0),this.category=this.category.reduce((t,o)=>(o.productAry.forEach(({product:n})=>{const{category:i}=n,l=new Date(o.user.address).getMonth(),h=t.findIndex(([p])=>p===i);h===-1?(t.push([i,...Array(12).fill(0)]),t[t.length-1][1+l]+=1):t[h][1+l]+=1}),t),[]),this.getCount()}}).catch(e=>{console.log(e),alert(e.data)})}},mounted(){this.getOrders()}},A={class:"p-4"},w={class:"row g-4 mb-4"},P={class:"col"},E={class:"card shadow-sm"},I={class:"card-body text-end"},C=s("h5",{class:"display-6"},"收入",-1),O=["textContent"],k={class:"col"},D={class:"card shadow-sm"},M={class:"card-body text-end"},V=s("h5",{class:"display-6"},"支出",-1),T=["textContent"],B={class:"col"},R={class:"card shadow-sm"},L={class:"card-body text-end"},S=s("h5",{class:"display-6"},"盈利",-1),U=["textContent"],$=s("div",{class:"d-flex justify-content-center"},[s("div",{class:"w-75"},[s("div",{class:"mb-4",id:"cal"}),s("div",{class:"mb-4",id:"bike"})])],-1);function H(e,_,a,r,c,m){return x(),g("div",A,[s("div",w,[s("div",P,[s("div",E,[s("div",I,[C,s("p",{class:"income display-4",textContent:d(c.totalIncome)},null,8,O)])])]),s("div",k,[s("div",D,[s("div",M,[V,s("p",{class:"expenditure display-4",textContent:d(c.totalOutcome)},null,8,T)])])]),s("div",B,[s("div",R,[s("div",L,[S,s("p",{class:"revenue display-4",textContent:d(c.totalIncome-c.totalOutcome)},null,8,U)])])])]),$])}const j=y(b,[["render",H]]);export{j as default};
